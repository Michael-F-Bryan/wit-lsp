<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Write your own tests and benchmarks that look and behave like built-in tests!"><title>libtest_mimic - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="libtest_mimic" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.2 (25ef9e3d8 2024-04-09)" data-channel="1.77.2" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-4c98445ec4002617.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../libtest_mimic/index.html">libtest_mimic</a><span class="version">0.7.2</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../libtest_mimic/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">libtest_mimic</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/libtest_mimic/lib.rs.html#1-558">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Write your own tests and benchmarks that look and behave like built-in tests!</p>
<p>This is a simple and small test harness that mimics the original <code>libtest</code>
(used by <code>cargo test</code>/<code>rustc --test</code>). That means: all output looks pretty
much like <code>cargo test</code> and most CLI arguments are understood and used. With
that plumbing work out of the way, your test runner can focus on the actual
testing.</p>
<p>For a small real world example, see <a href="https://github.com/LukasKalbertodt/libtest-mimic/blob/master/examples/tidy.rs"><code>examples/tidy.rs</code></a>.</p>
<h2 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h2>
<p>To use this, you most likely want to add a manual <code>[[test]]</code> section to
<code>Cargo.toml</code> and set <code>harness = false</code>. For example:</p>
<div class="example-wrap"><pre class="language-toml"><code>[[test]]
name = &quot;mytest&quot;
path = &quot;tests/mytest.rs&quot;
harness = false
</code></pre></div>
<p>And in <code>tests/mytest.rs</code> you would call <a href="fn.run.html" title="fn libtest_mimic::run"><code>run</code></a> in the <code>main</code> function:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>libtest_mimic::{Arguments, Trial};


<span class="comment">// Parse command line arguments
</span><span class="kw">let </span>args = Arguments::from_args();

<span class="comment">// Create a list of tests and/or benchmarks (in this case: two dummy tests).
</span><span class="kw">let </span>tests = <span class="macro">vec!</span>[
    Trial::test(<span class="string">"succeeding_test"</span>, <span class="kw">move </span>|| <span class="prelude-val">Ok</span>(())),
    Trial::test(<span class="string">"failing_test"</span>, <span class="kw">move </span>|| <span class="prelude-val">Err</span>(<span class="string">"Woops"</span>.into())),
];

<span class="comment">// Run all tests and exit the application appropriatly.
</span>libtest_mimic::run(<span class="kw-2">&amp;</span>args, tests).exit();</code></pre></div>
<p>Instead of returning <code>Ok</code> or <code>Err</code> directly, you want to actually perform
your tests, of course. See <a href="struct.Trial.html#method.test" title="associated function libtest_mimic::Trial::test"><code>Trial::test</code></a> for more information on how to
define a test. You can of course list all your tests manually. But in many
cases it is useful to generate one test per file in a directory, for
example.</p>
<p>You can then run <code>cargo test --test mytest</code> to run it. To see the CLI
arguments supported by this crate, run <code>cargo test --test mytest -- -h</code>.</p>
<h2 id="known-limitations-and-differences-to-the-official-test-harness"><a class="doc-anchor" href="#known-limitations-and-differences-to-the-official-test-harness">§</a>Known limitations and differences to the official test harness</h2>
<p><code>libtest-mimic</code> works on a best-effort basis: it tries to be as close to
<code>libtest</code> as possible, but there are differences for a variety of reasons.
For example, some rarely used features might not be implemented, some
features are extremely difficult to implement, and removing minor,
unimportant differences is just not worth the hassle.</p>
<p>Some of the notable differences:</p>
<ul>
<li>Output capture and <code>--nocapture</code>: simply not supported. The official
<code>libtest</code> uses internal <code>std</code> functions to temporarily redirect output.
<code>libtest-mimic</code> cannot use those. See <a href="https://github.com/LukasKalbertodt/libtest-mimic/issues/9">this issue</a> for more
information.</li>
<li><code>--format=json|junit</code></li>
</ul>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Arguments.html" title="struct libtest_mimic::Arguments">Arguments</a></div><div class="desc docblock-short">Command line arguments.</div></li><li><div class="item-name"><a class="struct" href="struct.Conclusion.html" title="struct libtest_mimic::Conclusion">Conclusion</a></div><div class="desc docblock-short">Contains information about the entire test run. Is returned by<a href="fn.run.html" title="fn libtest_mimic::run"><code>run</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.Failed.html" title="struct libtest_mimic::Failed">Failed</a></div><div class="desc docblock-short">Indicates that a test/benchmark has failed. Optionally carries a message.</div></li><li><div class="item-name"><a class="struct" href="struct.Measurement.html" title="struct libtest_mimic::Measurement">Measurement</a></div><div class="desc docblock-short">Output of a benchmark.</div></li><li><div class="item-name"><a class="struct" href="struct.Trial.html" title="struct libtest_mimic::Trial">Trial</a></div><div class="desc docblock-short">A single test or benchmark.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ColorSetting.html" title="enum libtest_mimic::ColorSetting">ColorSetting</a></div><div class="desc docblock-short">Possible values for the <code>--color</code> option.</div></li><li><div class="item-name"><a class="enum" href="enum.FormatSetting.html" title="enum libtest_mimic::FormatSetting">FormatSetting</a></div><div class="desc docblock-short">Possible values for the <code>--format</code> option.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.run.html" title="fn libtest_mimic::run">run</a></div><div class="desc docblock-short">Runs all given trials (tests &amp; benchmarks).</div></li></ul></section></div></main></body></html>